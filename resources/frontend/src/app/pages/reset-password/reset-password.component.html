<div class="reset-password-component" data-testid="reset-password-component">
  <h1>Jelszó helyreállítása</h1>
  @if (parameterError()) {
    <app-email-link-error />
  } @else {
    <p>
      A(z) <strong>{{ email?.value }}</strong> email címhez kérjük adja meg az
      alábbi űrlapon új jelszavát!
    </p>
    @if (passwordResetErrorMessage()) {
      @switch (passwordResetErrorMessage()) {
        @case ("BAD_CREDENTIALS") {
          <app-bad-credentials />
        }
        @case ("CAPTCHA_FAILED") {
          <app-captcha-failed />
        }
        @case ("CODE_EXPIRED") {
          <app-email-code-expired />
        }
        @default {
          <app-form-unexpected-error />
        }
      }
    }
    <form
      data-testid="reset-password-form"
      [formGroup]="resetPasswordForm"
      (ngSubmit)="captchaRef.execute()"
    >
      <div class="form-elements-container">
        <app-password-repeat
          [formGroupName]="'passwords'"
          [showMessage]="password?.valid"
        />
        <re-captcha
          #captchaRef="reCaptcha"
          (resolved)="onResetPasswordSubmit($event)"
        />
        <app-button-loadable
          data-testid="submit-button"
          type="submit"
          [loading]="isPasswordResetInProgress()"
          [disabled]="
            isPasswordResetInProgress() ||
            parameterError() ||
            !resetPasswordForm.valid ||
            !resetPasswordForm.dirty
          "
        >
          Új jelszó beállítása
        </app-button-loadable>
      </div>
    </form>
  }
</div>
